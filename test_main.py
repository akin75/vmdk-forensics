from utils import calculate_shannon_entropy, calculate_chi2, to_bin, to_hex, convert_to_nibbles
import numpy as np
import os

#random_generated_byte = os.urandom(512)
random_byte1 = b'ly}\xd0\xa7\x1c\xcbs\x0e\x9e,\xd9\xf8\xc2\xc0\xa8\x0f\x97}\x9b\x1dz2\x0b\xc8\xdd\xe1\xc90G\x1cn\xde\x94\x17\xfd}\xf0\x9dzzx\xe8\x95\xa3\x8cX1T\xcdCRH\x0e\xca\xf8j\x97\xa6c\x95\xdc\x99\xe1\xfc\xc0\x7f\x85\xa3t@[Q\xcaDDyp\xb4\xfdd\x89\x94\x1d\xde\x9fh\xb7h\x7f^8\xc5giA\xe8\xf2?=b=\xe1\xa43Q/n[\xf5\x0e \xb0\x95H\x17\xc3\xff\x9e\xfb\xda\x057\x9a\xa0\xc0\x1c\x15G\x1e!a\x95\x14\xb7\xb5\x1f\x94\x05\xd5o\xb8-\x16:g\xfe\x13\xba\xc2\xb0,6\x15\xac\xd5\xb0\xc8\xe0\x89tV\xbd`|\x0e\xcb\xeafy\xcb\xa9\x82\x80\xb6\xda\xb3&mkuR\'C\xab\x9b\xde\t\x17t\x9fOq%\x10Y\x83m\x86\xd5@\xd7\xaf>W\xe4W\xa5&\xb2\xd1\xa6\xba\xd5\x84\x08B\xb7\xdd\xcf\x7f|n.]<\xe9}\x81\xbe\xd0\x18\xbb\x87\xe7)\xd51\xaf\xcc^\x03\xcd\xb6\xe6\xb0\xf8\x1eo\xbf\xa0\x856S+\xccQ\x96\x9c\xa0C\x0f\x91\xba\xd9\xed\xc9o\xc2oi\xdfV\xebE\xe5\x81p\xfe_\xdd\xae6^\x9b\x81\x8c\x03\xa4\xdfu\x9a\xd0\xa8\xa9\xd0\x9a\x9c\x01\xbdH\xfc\xbeqay\x93\xd8\xee\x16T\x13\x80\x7f\'\xef\'\xab\xe8y\xe1\x86]\xc2\xed~l4\'s\x86\x1b\x0f\xfb7Ll\xe0\x06#\xc7\x8f\xa8\xffq\xfbV\x8aS\x9cThp\x1cH\x9d\xce\xf5l\xa9=\xdaY\xd4X\xa7\xe8\x85\xe8\xd9\xd9 \x0e\tI\x9c\x11\xadm\xf0\xac\x1f\xf3\xc5~\xa1\xb8}\xf6\xb4\x85h\xb8~\x9f\x88\x00\xdb\x14o\xea\x0f\x8bj}}\xa8\xcfD\xe5\xcc!Y[\x91\x99\x05r\xc3="y\xab\xa7:)\xa3\x82\xa4"R\x153\xdb\xeb-\xf0\x0e\x92\x05+\xaa\xb7\x10U:j\xb2\xa3`\x1b\xf8<t\x04\x9a\xfc\xe75\xcf\xe9uC],\xecd3\xee\xef\xd17N`/\xadT\x8e\xf0G\xc4\xde\x1a\x8a\xc1W\xd4\xe2}3iq\xd1\xfdDrsE(\xf6\x17\xdeO\xe8\xdbRB*\xfb\xa2\xde\xee'
random_byte2 = b'\xb2\xd3\x8cWL\xc35p5\x05\x83\x15.\x9d\xdc\xd1\xe4\xfa%\xb4W\xb7\x95\xc1w\xb0\xee5\xc5p"\x16H\xdd`\xd3\x90\xbc\x07zP+\xf4\xdb\x18\xfa\xfe8\x8d\xcc<\xd8%8x\xa3\xa4\xa2\xe9\x8b\x81\x19\xd0F\x9bU\x9f\xc5M7<\x82\x8a\xaf\x89\xcf\n]\x1c=\x90\xc34;v\xb9UNa\xae\x0e\x9d"A\x8b\xbb\xcf\xa3\x9f_\xc4\x16l\x99O\xfd\xa3\x95\xddh\xe6\x86I?\x05\x97@\x94,\x03\xf9\xaa\x06\xde\x13\x12\xbc\x85\xc2\xe6Uxs\xff\x8f\x1c\x8a\x9e\xc4\x19o\x86^\x9b\x16\x9fv\xd1N\xe4|\xe6!\xb3\xe0\xc7\x83\xa4\xa3\xf9\xa3_\x83\x9b\x90\x1e\xdb\xa0\x1dh\xd3jk\xa3\x9b\xc8q\xb71\x90\x82\x13\xc1l\xaap\x03X\xd1t\xc9\x8f*\xe4\x10\xd5:%\xf9\xeamdC\xe5\xd4\xbd\x04s\xd1\x0f`\xa8\xcfL?-\xb3\x1fA+-\x0fCR\xf6\x8a\xbd\xadn\x08\x937\x91\x94\xa0\x01ii\xaa\xe2\xbf86I\t\x10G\xf7#|\x9e\x80\x9f\xb5\x90\x04\xbcK<i\t\x1d\x18\x19\x1a\x92\xc2\xc6J\x7f\x86\xb6\xe7\xa1\xc7\x7fS\xa4L\x10\x8d\xefw\x80C\n\xd8v\x18\xc3\x9eVsxp\x17\xa8\xc7\x1f\x9eP\xb0~>\xd3q\xf8\x93\x07\xf9\xdd\xaey\xe5\xe4\xaevX\x1f\xcf\xa0Sx\x05\xf7s\x8a~u\x1d5\xd9\xfa\x8d\xb5%\xd6\x16\xabKm\x1cR4\x16\xde\x0eU\x90\x04\x1b^HN\xd6\xef\xa6\x9eh\x02\xa9\xa5UW\xd9\x0e\x7f\x8a\x90\x95\x03\x10\xa4\x8e\x00\xd9\x91cb/\xc1B\xdf\xbb\xd8].\x8b\xe3@\x8b\x1f\xd8W\xda\x9a\xdai\x97\x83)\x82\x95r\xb1\x0354\xdb\xe0\xa3\xd2\x7f/\x10-\xb6\x88\xbb!\xda\x05?\xe9\xc2\xe4\xb7k\xed\xff\tx*Q\x16\xc3\xd7\xccE\xfd\xc4v\xc0\xc88>z\x85m!g\x1aL\xa6\x0f@9B\xe09a\x01n-\xcb+l\x1c\xa2\xc6\xb9FXG\xb2~\x1c*\x80|\xab\xcae\xc0\xf9\x18d\x8f\x1aI\x97\xe0\x1b\xd8W\xb8q\xe2\xb2\xe0\xbf\xc1\xaa\x98\x11\xe0\xb2+[\xec\xcf\x00'
random_byte3 = b'\xb2&\x9d\xb0\x17O\xfeF\xb2\'\x8f\xe1\xcf\xf2\xc9{\x11\xdb\xfd8\xa4\x15t\xec\x92\xaf\xeb\xb1B>\xcb\xdc\x8bO\xe1\x19g\xe6\xd0\xd94\xef$b\xfcf\x0c9\xc2<\xd7\x82\xf7\xdc\r\xd7\xf6Djn\xabu\xa2\x90\xe3\xcfH\xb2\xfa\xf7L\x91\xd7\x01\xb8\x1b\xc0X\xef.\x96\x8e\xb8xgd\xea\x00\xc7\x89\xa9w\x11@\x0f/\x16K\x8b@\xeb1\xf4?t\xd4\x02\xae\x95\xc5\x96\xc5\xd8\xba`\xa1`\xf7\xe1H=1n\x02\\\x1a\xc0I\x8eW\xb7\x05z\x8d\xb21\xf1\xf7\x8f\x0e\xc2O=8\xae\xa5?\xd5\xec\xd1R\x9e\xe5I\x00#\x10\xd9h?\xeb\xab)\xef\xb2.\xedq\x0eYs\x01/\xd7`\x1f(<?\x8a\n\x15\xa9\x1bb{M\xd5K\xb0\xeb#bU\x06\x84\x85b0\xa7\x88\xdd\x12\xaa`4~\xc6\x8e\x8f  \x01\xe4~\xba\x02\xcfld\x98\xa9\xc1\xb2\xb2P\x0b6\xd1\xf0\xc1\x19$\xe3+l+\xe4m\x08\xac\xaeU\xf7\xb2\xa1\xef\xa5\xcc]"\xd8\xf3\x1b%E\xca\x7f \xe3\xeb\xf5\x8d\x14\xff\xa3\xa0i&\xf5\xda\x0fR\xff\xa2\x83\x9d\x7f~\x0e\x85K\xf44\xf6g\xef\xdb/\xa5c\x10\xc9\x14\x81\xdb\x94\xc7\x01\x16\x13+\xdb\xe8\x14\xa8N\xb6hp\x0b>p\xf3\x9e/\x99\xd1\xea\\k\x17\xc6\x10\xd8d\xae0\x89\xf2:\xc0a\x0f\xbd1!\xe7r\xe8\tD\xa7V\xdeU\x9e\xaa\x11aZS\x12\xd8\xc0 /\xa6/j\x81h\x90-\xcb\xc0\xe6\xe0\x13\xc7\xd5<\xbd\xc3\xf4\xa8f\x10J\xafz\x9f\x95\xb8\xc3#+@\xf0t\xea\xd5\xb0\xffe\xf0\xfd\t;_\x83;\xc0\x91\xdf-p\x93\xa1\x8b\x06\x84n\x8c2\x06aY\xd6G\xb5\x06gu\xeaq\xb4\x9f\xe0\x92\xffu\'\xc2\x1e\xbdD\xf9o\x00\x15\xc2o?2h\x98\xb2\xa1\xdaB\xcb\xd3cL\x98\xa0\xa6-\x0f\x13 v\x9a\xd1\xc0H{k\x9c\x0fV\xdag\xf5\xe8~\xe4\x81i\x08MXI@<\xba\xd8\x87\xbd#[\xf5\xb5\xbd\xad\xee-X}\xb0\x05\x8e\x84\x8e\xad\xe7\xdc\xb2\xecX\x8d'


def test_calculate_entropy():
    chunk = b"y\x8fF\xb6\x01^7P\xb2\xffc\xd7\xdd\xf6\x00\x898\xb2\xdbg\xf7\xa7\xceC{\xecC\x96\xc9\xa1\xde\xba~\xb7\x1b\x89\xa9-F\xa8\xd1|Z/\xeb'U\xcc\x02{y\xa9\xb1f\xad(\t\xdb\xf2\x9e\xfc\xa1d="
    array = np.frombuffer(chunk, dtype=np.uint8)
    expected_entropy = 5.71875
    actual_entropy = calculate_shannon_entropy(array)
    print(to_hex(chunk))
    assert actual_entropy == expected_entropy

def test_calculate_entropy2():
    chunk = b'U\xd2\xdee\xa7r!\xb1j\xbf&\xa9\x8f\xd0\x8b:\\2%\xecJ\xedd\xbe\x89"\xac\xff\x83\xab\xfa\xee\xecx8\x9e\xb1\xf5\x16\x1cu\xb1\xc2\xd00\x15!\xb4aO\xc1\x9c\t\xf1)^p\xae\xa5\\\xc4 \xe2\x9f\xdc_\xd9\xf3\x93\x05\x14\xa5a\x8bs\xf4\xf6\x9c\xf9m]\xba\xa5\xc0\xbc\xe4++\xc2qV 9\x8e\xe5nx\x91[\x12ZoUv\x7fgq\xc2a\x16Y]\xba\xa3\xfcn\xb04\x13\t\xcbQD\n\xa7R4\x861\xff\xb6\xc3\xd7\xf83h\xe2\xee\xaf\x7f]W\xb5X`\xa2&h\xfb\xa1\xb7\xc3\x9b\x065\x90\xdf\xa1>\x80cz`\x94\x14\x92\x89a2G\xb1\xce\xe0\xa4\xd42\x9b`\x0b\xeeEJ\xdc\xca\x9d\xba\x86&\xbeT%\xa0R\x8b\xf3\x85\xe0\xf7\xa4\xf1\xafK\x94\x9d\xb0\xd7h\xaf\xa8\xa7\xe8\xeeo\x87\xcc4\xbe\x81O\xae\x8cTO5G\x84l\xe1\xde\xd6$\xeb\x8b\xce\xca\xeb\x92\xc1\x08\'\x07`J\x0eh\x9f\xce\xb0rg\xc0\x07~p\x1f\xf7\x0f\xd9\x91\xcc\x8aB\x0f\xa6U\xbfXH]\x85\xab\ry\xcde\xd5\x18\xd4\x18\x9b(PV\x9d\xe03\xb5\x1b\x02\x1dX\xda[>\xaei\xbd\x13j\x9a\xfaS\x89\x9c\xdc\x92=\xf8}\xc3 \x87]\x9b\tu\x9a\xad\xaa\xefs0\x95\xa2\xb0:\xb4\xc5\xff\xdc\x02q\xc2A)\xfe\xd2\x849\xfaO$*\xff@\xee\xc3\xca\x1dE\xff\x9a"\xf4\r\x85\xbf\xb0\xee\x82\xe3\xd0\xb9\xaf9\xc9\xd7\xef\xde\xa5;\x1f\x19G{\xd7Q\xff\xf5;&z\x18\xd2hNO\x96\xe6\xad\xf4\x1d\xe3\xf5\xdf\xa9\t&BW\xa5\xae\xc7\x8bx\x8a\xb5JA%+\xbc\x0e\xb0]\xf3\xf5!\xe8\x10X\xa1\x7f\xc9\xd0\xe4\xbf\xb2\xa9A\x14\x0c\x07\x91\xdfq\xab\x80\xf4\xf6\r\xa0\xe7u\t\x84\xb6\x18\xdb\xad\x8c\xa7\x00\x91\\Q\x90\xbf\x10p\xba\xb0".x\xd2\xf62\xf9\xd4(\xf7\xb7c\xe5t7D\x06\x81\x18"\xc3\xdf2nI\xdd\xe6\x8ae\xf0\xfa->v\xe6\xc7\xb7\xa9\x89K\xee\x8d\xf8\xf8\x12\xcfm~~\xd5\x9d\xf1\xcc\xab\xd4\xd9\xf5\x02\x03\xd8\xb5f\x8d\xa0\x13\xbe\xf0\x99\x8f^\xbd\xc1C\xf1mr\x157g\xcbxU\xe8)\x04\x04\x19\x81\x1f\xe0]\xba\xd9#\xfe\x84V\tX\xd6z]`>.jR\xd00\xb4\xc2\xf1\x94\xf9m\x808\\\x88D\xa5T\xd9!\\\xb34\x10\x10&GX\xef\x97f\xa6\x97y\xc5\xf7\xa5\x91\xdf\x8a,"\x9d\\\xe6>?\x8aq\x12\xc4\x8d\xb3;p4\xa3\xd4\xe9\xccqd:\xf1qS)\xf0f;2s\x145\tg\x94HjA\xf6S j\xd6\xbb\xaa\xc3U\xf9)=\xa7\x83\x14t\xa9\xf6\x9eY3L\x1cv\x8e\xaa\xf9\xdb\x96\x93\xe2<\xe8\xb32\x10\xe6(,\xdc*\xd2\x0b1(\x195\xc6\xfb\xb4\xf3\xb0\x08\x83\x845\xf1\x15iw1\x06k\x02_j3,\x99A}x\xb7\xfcb9\xech:\xb9R:|q\xe9\xef\xd96\xed\xdc\xd8\xe0\n\xf9ERZ\xf4\xd2\xae\xe5*\xe6a\x07\xfdQ\xf7\x90\x8d$Rk\tM}\xdf\x9cJ\xe1w\xa8\xf3\x90(#\xc3\x06X1\xa59\x12t\xc6\xff\x93\xaf\x80\xaa\xe0\xb4\x08\xda\xa6\xbd\xe5N_\xe80\x90\x92\xcc\x0e\xc5\x92=;\xa2/\x18@\xeaL\xf9\xb8\xde\xbeq\xef\xca\x07>\x90\x12\xec\xf4\x85\xe3\x9c\xcdq|\x18\n\xa7%\x8cS\xd93\xb2\x8e\xdf)\xa5p\xd6\x8a\x93\xc5\xc0\xfd\xfdT\xde\x17tH?\x87\xb1\xce\xb8\xf0 s\x8f$\xf4\x15\x95\xb3,>\xbc\x90}\xe9\xf8ch\xf1\xa9R\x19\xfa\xa6\x8a\xa1\xdc\xde\x81\xbf\x8d%\x90+n$7jc\xc0\x10\x15\x966dw\xf6\xa8\x1e\x82\x9d\xbf\x92\xfci\xf0\xe5!"8\xb6\xc0s\x16\xe9\xa7\xeeWh\xb9\x14E\x9c.\x18x\xfe\xcf:\x16^\t\xcc]\xea\xab&\x86\xf5\x7f\x99\xb1\x03^\xcbf\x85E\xb8\xd2_8\xd2\xaa\x89b\x9cQ,:\x9e\xcd4\x83\xbcD\x8b\x81L\x93\xeebjGy\xa0\xca\xa7\x87\x9c\x80\x89f+\xf0v\x91C\x19\xdd\x0bk\x9c \xa0\xd8\xf0\x0cmG.U\xfd\x94\x1aSm\x8aC\xfa\x92\xc2\xe9;\x89\x0e\x86%\x9f\x18\x16\xd7\xb4\xcf\xcfh\xe0/\xb7\x83\xf1f\xf0v%8\x9f9\x8e\x1e\xbe5\x93\x81\xf8\xf3\x03\x81_\x05\x82\xfe(P\\\x93^P \xd9\x92\xb7Z\x1e2\x15A\xfc\xa5\xbd\xa8\x01@\xeb`b\xbb\xc7\x84Rd_k\xff4\x1c\'A\x91\x9f\x9bS\x19\xbaV\xe8\xde\xac\x98\x89\xab~6\x81\xce\xa3[\xd5\x82\xd9\x96\x05\x81\xb7\x9b\xc2\xfbCB\xa8{\xbe\xac"\x1b\xcc\xa6\xea\x8a\x86\x1c8\xed\x04ce\xac\x1f\t\\\xdc\xf3;T\xec\x91\x84\xfe\xd3\x0bo`H\x9b\x9f\x83\xadWMz(H\xe9\xbe0\x00&\x80\x7ffj\x1cF\x84\x9d_\x08\x0c*\x1a5\x86\xc5N#\x9b8s|\x13_R\\\xbb\xa2?$@\x956\xdaM\xcb\x9ai\xa7gM\x08Fu+\xdbj\xa4\xf3#\x1a&\xae{8\xec)6\x06\xce\x05\xa5j\x1dg8\xf2t\xdc\xe96Y\x8b\xdb8\x7fm\xbf\\\xc7\tkD\xab\x90u\x18\xa0\x9e;]G\xd0!\xcb1\xa9"\xac\xf0`\xef\xa0x\x81\x8f \xf3\x90\xd0S\xc9k\xa4\\\x94\x92s\xd4\x15\xe1\x137\xa4\xa6\xd6\xdeg\x85\xa3\xcc\x87\tR\x01\x0e\x17\x0c\xcd\xb7\x84u\xec\xe6\xa1\x01z\xcf\'\xd6\x0f\xeeE`C\\6H\xe3\xe9\x9a\x81KS*\xc3*\x03\xeb\x17\xf4*\x8df\xf6%\xbd\x86\xec\xb3j\x1b\xff\xbe\xd6\x01\x13R\xff\xb5&\x8a\xb9)\xe0;\xa5[4E\xbf\xf0\x8f\xd2\xa6\x19p\xd1~\xe1\x1f\xd5\x15\xff\x10\x9eM\x08\xc253\x10O:\x99\xde\x19\x8f\xb7\xa7q\x0b\x8d\xf1\xbd\xb4r\xfb=4\x99\x0c~\xb4\x05\x0e\xad\x8a\xbb@y\xc8\xe8t\xec`\x88q*U\xce=F\xeb;\xdfM\x0f\x90OG\xc1\xf3wENY\xbe\xd9gw;B\x87?\xf7\xf8\x11\x88\x80\xbc\xe4J\x92\xf3)4w>\x195w\xad\x1e\xdeH3\xc6a\xdd5\xc1\xf1\xae\x0e>\x92\x8c\xcd\xf7]u\xa5\x8dT\xe4u\xee\xf3\xbbz\xb4\xe7"\xd7\x04\x1a\xeb\xab\x8f\xb8\xcfEC\x1f\'0\xa9\x93l\x1cq\x9f\xc5\xf7>\x81\x01\xdb/J\x05\xf5j:W>\x891\x94I7~\xba\xc1bA\xb1\xc9\x11=,\xf9CB\xda\xe4&\xa1\xf2\xe2d\xb9d\xa2\xf7A\x90\xd2=TfX\x0b\xec8dS\xce\xa5\x8dw\xb3\\]\xe3\xbb\xc2N|N\xe4\x18\x81Y1AX\xb6\x18\xffj\x10\xb1\xb2\xb48\x8c\x14Y\x95\xfa\x82(\'^\xe4\x8e\x02\x8e\xa8\xc0e\xb8\x01\xa4c\x8f\xd3\x96\xe3\xd2\xf7\xc3\xd3!\x94\xdf\x16\xc2\xe9\xe0\xa0E\x0f\xb1\x0f>\x01\x8e\xc6(%\xeb\x05M\x0f\xf8i\x1a0\xb30t\xe6\xc1\x92y\x9a.\xbcc\xd3\xdbs\x19@\x0bm\xcc\xac\x10\xc6\xd2\xdb^<\xbd!\xaa\xd0wO\xb5\xfeS\xfe]\x04W\x8b\xf4`\xd5bn\xcb\xfe%z\xdd\xe4^\x9f\xcaX`\xbeP9\xef\xdf\x19eX1.\x14\xcd%\xd3\xe0\xe9s\x04\xd2\xe5\xa6\xd4zv\x1d\x86f\xdb\x14\r\xb0R\x048\xe1R\xeap\xe8\xfeq\xf6m\xeb\xbbl\x166\x9d\x8e\x95\xb0\x90\xd8\x95\xab[\x9a\x05/\xf82s\xbcm9\x0b\x94\xcc\xdd\x19\xd1\xec;\xeaD\x14\xd0\xfa\x90iSn\x94s\x83@\xbb\xec\xfdw~\xe9\xd5\xc0\x9e\xbd\xf3\x06>2/\n\xda\x14f\xde\r\xd8\xd3\x93e.r-^h\xb4*\xe54U\x11\xae\xafm\x06\x8en\xb5\xe4\x1a2F\xf7\xb5\xbd\xb8Y\xa8\x0b\xd0\xb5\xc8*\xa89#_\x96\x82I\x88N\xab\xb0\xcd\xb4\xb1\x1d]\xb5\x8a?\x04\xbb\x83\x17\xd9\x07p\xf2\x9aS\x90\xcea\x93\xb4\xe6\xa5\x97"\xb3\x96\xe4Y\xb18Z\x85\x84osEs\xde\'z\x9b\xe2\xc5\xcb\xa9\xd3\xa0\xd0Ig+\xfev\xca\x1e\xb8\xfa\xb1oe\xb7V\xff\x00\xb98\xd9\xaaB \x01\xa4*q]\xcf\xd5\xd4(\x02 _\x84!\x95\xdcuPk}\xb6v\xc4\x046_u\xd7\xf7\xce\x9b\xfdSM\xbe\x9a\x82\xc6A\x11G\x812\xa5\xc4E\xcd\xe6\xea\x81]A\xf9\x9c\xdf\x85.3y\xb3\xa1\xc5\x8f\xf1lZ\x12\xc6\x01\xa7\xb9g\x19\xb15zW4:IgA\x93^\xfc<\xc0n !\xff\xdcd\xca\x971K5\x19\xcb\x0e`:\xbb\x89Do\x0fV\x80p\x96\xb6\t\x0f#\x89\x9b\x88\x11\xcf\xfe\xee\xeat\x9a\xf1\xe9v\xcd\xe6\xa4y)R\x82Z\xbd`\xb8\x93\xb1\x1b\'\xdb\x08\rc<D\xf0F$\xe0\xce%\xd4\xb5\x04\xe9"\x8a\x16\xc2\xe149\xa6\xa3\x98\xddv\x7f\xc6y\xa7y\x0cb]\x8b\x8e\xc67\xa4\x86i\xa2\x99\x02I`0J\xd0\xa50\xff\xf6R\x08\x0b\xf0b\xfb\x9f\xba/RzV\xbd\xb0n\\\x81K\xcc\xaan\xf8\xd5\'\x13&+\x8f\x048\x03c\x11N\xac\xeb\xe6\xd98IG\x10\xb3&%\xf8d\x07\x04\n\x12\xca\xa1\x06$\xe3U\xeb\x88A\x82`\xcf\xfe\xc0\xdc\xa8\xf0\xc4\x8e,<\xc4\xa4\x08~\xfb\x0c+!\xd4(\xba\xcaFB<\x90;<tu\xaa)Y7\xa6\x88\x1fy\xc9\x9d6\xf5\xbdD}\xc8Lj\x9c.\x95\x99h\xbe\x1bO\xc5ps\x0c\x84\xe64\x02\xb2V\xedj\x1bHP\x971\x04\xcb\xa3\xe23\x84\xae/5\x1dR\x06\xc5\x89\xdd&\xd1\xb14\x80f\x12t\xbe\x04wn\xff\t\xeepj\xde6\xcf-\xd6\x81\xaeF\x05\x03 \xd3\xe2?\x9c\xfe\x18 CW\xb5@a\xed\xce\x16\x0b\xac\x91#\xddsG\'\xfb[\x80\x05\xfc\x8e\x17\x88D\xf6\xef"\xc8<\xc1n\x05\xa0)\xb44B\xf2\x8c\x00u\xdd\x116\x94\xf2\x03OIY\x9b+\x97zd(\xaa\x9e\xee\xf2\xe7o{\xe5_\x86\xec\x9f\x90\xf4WF\xdc\xefL\x9b\xdd\x847\xeb\xcb8\xae\x10\xbb\xbd\xa4\t\xec\'\xa9\x9d\xaa<\x15\'\x16\xa0\xcd)\xf8j\x97\ta\x10r+*u\x15\xe9\x0e\x85?D\xf6\xc6\xde\x1f\x7f\x8fCc5\x02&.\x18h\xcf\x963{\xdcw>\xa89{\xff\x1ffe\xb2As\xe7\x90gwg\xd9\x13\xff\xc2\x10\xd4\xc9\x9b\xbaM\xe8R\x02\x15; r\xb0\xf1~l\x0c\xce7<5\x1cRt\x83\x0e\xc7,\x00<o\x93iE\xe1\t\xed\x98M\x8e!r\xc6\xdd8\xf6\x83\xcf\xa1K\n\x84\xd5)\xcc\x8b\x1c;\x80\xda\n\xd1\xfe\xb0j\xf8Ku\xa0\x9a\t\xb2\x97\x89\xba/~\xe2\xc8\x80|w\x95\xa1\x9d\x01;\xdf4\x1a@-\x82\t\xf8\xd9\x91\xe2\xed\x9d3m\x08$r\xe1\xadq\x82\x02D\xf7\x15\xa0E<yh\x9f\xc4\xbc &\xd7\xb2@pm\xcf\xea&w\xa3|\xc8\xf6\xc7\x08\x84\xba\x85\x8f0\x87 0\xc3\xdf\xfb\r\xff\xb9:\xe8<:\xc4KNJ\x04\xe8\xa0@\x82b\x1e\x89 \x9eWd<\xda$Lc2\xa0p\xa0Q\xc3+R\x1dDx\xf7\xe6A\xcf)\xb4[\x16B\xb8g}MS\x1c\x81,N|\x12z\x9b\xea\xa3Q\xafO\xf5\xeb\x1c\xabl\x86\xefW\xd9\xdez3L\x16\xc5L#=\xb5\xf7m\xbf@\x1e\xe2 \xcc\xd5\xc7!R\xeco\xc3 Zv\xb8{r\x9ee\xc5\xad\x16\x8f\xb8\x1d\xd72\xa8\xc2\xf8\xc1\x080\xd8\x1a\x00\x1c\xb6\x16\x86cnS\xe7\x08\xbd\xc1r\xddX\xfd\xd2\xe0)\xa1^\xfb\xdeTV\xf0S\xc8r\x00\xb5D\xe7,\x1a\x19\x19i\x8a\xa2\x1cj\xd8\xd6\xe9(\xcb\xcc2\xe0\x90\xae-\xb3]\xdfx=\x17\xb9\xd8\xc3m\xac,\xa5\x97\xf6rTd_\x12\x94r\x83f\xe5h\x95 C\x9e\xce\x88\xf7\x10\xea^w\xca~vi\xddG}\x92\xea\xc6\xc0\xd7O\xe2O&*\xafEP\xecX\xb0\xcc+/\x96\xc7I\xbct\xa4\xf4\x1b\x9d\xd1\x00\xd2\\\xf4.\xd9\xad\x1fs\x82\x81\xab\x80j\xa3\xd4\xeb3Z\xc44\x96\xc4\xdd\xe2\xba\x1f\xeb\xf7-\x10#\xbf\xe5\xcd\xdbc|\x86G\xb2Y\xa9o\xb0hM\xa9&\xa0\x17_pe\x9de\xca\x0c\x82\x0c\xa2\xe7\x10\x82\x8fy[\xf4\xaelT\xad7\x8f\xa7\xda\xb5\x01~L\xd6\xa9\xb1e\x1d([\x9c\xdeZ\xc5P2\xe5\xd2\xa7N\xb8B\x19\xf9\x03U\xe4G\x8e\x0c\xda{\xc7\x06\x13\xa4\xf4\x0eE\xe5\xd6\xdc\x8e\xff\x90x\xbb\xa6\xaa-\x97_+\xc6"\n7\x04\xaf\xf9z\x92;\xe2M\xdc\x19%\xa4\x1f)\xe3\'\xfa\xf56\xae;\xff\xd5\'\xd3\\\xc9\xd0\xb5l\x11[%\\\xd8\xb5\xb4\\hO2\x8f2\xce\xc2f8Ru=\n\xa0{\xef\x19\x9d\x0bI\xa0\xa7c\xea\xb3M\x11\x8ez\xba\n\xce\xcf\x97\xc8\x81\x14\x90@*\x98OZ\x90;\x1d\x7f\xd8\xff\x06\x96g\xd1\xacHr\x0b\x18?iU\xdf\\\x88/\xc0\xc0\x19g\xde\xd6}\x19\xb0\xac\xf7Dk\xdf\xa2\xefRj\xa2(#r\xe5)\x00\n\x83\xb7\xb4\xc6~\xa3\xcb\xa2\xeb\xc5\x96(\xa6\x16\x0e\x1e\x92\x8c\xa2@\xa7\x08\x8d\x95v,_\xb8\xdcOb\'\\PN\x90))l\tWW\x19\xe7\xcd\x7fos\xd0\x80\xb8p\xfc\xa7\x97\x0c\x04s#\x9f1\xf4\xb0\xb7\xaaF2=nB\xdc\xe4\xa3\xf7\xcf9\x13\x9e\xdd\xd6\x8603\x95\x10\xf6y\x07\xde\x08B\xf4\x01\xc0!\xd1\xb7`\xce\xd5\x07\xfd\xe6H\x8d\xc2\xa4\x139\x05gv\xb1\xdf\x1aQe*$\x89\x05K\x1b\x038ZS1\xe5\x904\xd2\xf7\xbeG\x91`=Vx\xc6+\x86{O\x0e\xd6\x1e\xff\xd3\xf0\xf0\x04\xf6\x0c\x8b\x8f4C{\xe1\x065\x03\xa8\xd385,\xaf\xde\x81\xbb\x19\xd4[\xb3\x93\x9f\x9c\x8e\xfa\xcb\x88\xb7\xa4k\x92\x9bc\xe1\xe2\xc4N\xe1\xfe`\xd5T\xb6Q%0\xeew\x80\xdc\x080q4S\x17/\xc4\xbd\xad\'\xaf\x8b\x97\x8c\xafv\xa6\x9e\\Z}\x91I\xcd9\\\xfd\xf8\x95\'\xdb\xf5*\xb3>\xaa k\x89\xa6/v\x1d\xb0\\\xd7\x88N\xbc\xe4\xda\xe4\xf6\xe4\x08\xc3l\x9c\xd1.\x82%\xc6j\x97\xc9\x99x\xed\xed\xdaTbv\x80\x06\xe0\x19\x88\xa4\xf5&`\xff]" \x8f\xccd\xf1\x85\n*\x8f=Y\xb0\xc7\x84l9S\x1b\xcb\x97\xb0\xa7\xcd#\xf0\xdd\t\xc3\t\xf9\xcb\xb7P\x8c\xc3\x15"\x9d=8\xa3\xd7>\x0e\xc8\xea\x14TA\x850\x91\x93\xb9X\xc6r\xfc)\xab4\xa9GNzv<vB\xb9\xf0\xa3\\\xdfB\xb7\x9d\xa9\x99\xe2\xacg|\x9cf\x8d\x9c\xa8\xc3\xc8\xb5(\x1cS9d%c7\xd1\x02\xbe\xbe\x96cn\x91\x0c\xcd\xa0A\xb1\xdf\xd8\x024\xa4\xb8\xf0[\x92dx-\xea\xaah\xc9\xe8w\xa9\xde\x02\x11\xaf+\xe0\xbe\x98\xe0\xdb\xb6\xf5\xe7\xacW\x88\xf3w\xf8\xdf\xfc\x0c&!\xeeZ\xc6\xcf\x91-\xbf\xc3\xa4$\xac^K^N\xe87\xb8l8%\xe5\xd3\xf6OQ\x1f\xc9E\x0b\xfb\x81\x7fU\x00:s\x80\x03V\xed\xff:\xf2\xdc\xa0m\xf8%\xfd\xfa\xbb\']~FB`\xfdH\x0bR)]\xb3"\x14k\xc9\x07\xe8\xb1y\xde\'\x15C\xa3p\xc2s\xaa\xef\xcb0\xda\xac\x14\x95\x16]\xcbh\xa1\xe3\x02\xb7\x86\xa1\x18 \xc6\xee\\\xf3h(\x01\xd5\xe6\t\xa3\xe43h\xc8\xb1\xb9V\x87\x81\x85\x96{\xef\xc1\xe9\xd4H\xad\xc2u\xc2x\xa0&\x1d\x15\x0e\xd8\xf6.\xbc\xa0\xcc\x98\xf1<\x1a\xc0\x87\xedK\xde^N\xf3\xc9\x7f\x0cXu\xdf\xaf\x0eC\xae\'pr\x9d$\x14(\xce\xfa\xf6g\xf9\x15-\x17ty\xf9\xc1Qj\x8d\xeaz\x99\xb6\x80\xb9G\x04\x8b\xe0\xc1\x18pH\x84w]\xc40\x1d\x18\xba9\x1c\xb3\x1cj-\xa8\x10\x08\xb2\xf4\\E\xc8\xd7.8\x12\xc1\xc8\n\xda\xbc\xfd]\x8c\xf7qo^+</\xd2\x8b\xbf\xf9\xf3\xcf\xc5=\xeb1\xa2&\x92\xe9\xd9\x1b}\xe1\xdb6\xdcp\xbe\xd7<\x00A\x9c\x13\x9du\x18ff\xa6\xff6\x85\x1c\xa4\xbf\xdc\r5\xf4\x16\x82\xb0L\xc4\xb6\xc8\x98\xfb\x1db\xb6\x0f\xfd\xc1\x7fz\xaf\x92q\xec_\xb7I\x0f\xc1\x1d\x87\xbe 1UX.\xc84F\x117\xe4\x7fR\x05\xd0m[\x9e#\xa7\x0c/\x1a\xaf\xfb\xf1\xd2\xbe\xdc\xde\xc5\xe7\xd2-\xf9\x92\xe3\xdd\t\x1f\xc8?\xf0F\x8d\xdbg\x0c&\xd2\xa5m\x81\xbf}\xcd6`7(Y\xf4r\xe2i\xaf<\x155j\xb1~\xe9&\xe4\xb0%v\x1a\xb9%d\xe4\x128cS=W\x9f,\xac\x8e\x16\x9a\xdf\x1cI\xefO\xbd\x8e\xb7uX\xcf\xe7?T!\x97\x86"\xb8Ca\xd7\xbfuM\xbfg]X\x10\x8ar\x80(\xfe\x00\x88\xf0E\xfa\xfb\x8b\xb4\xef\xad\x84\t\x08\xfd\xc8\x19@\xb2z\xc5\x8f\xe9\xcc\x92\xd0\xd5\xec\x93\xac\xf5\x9ft\x10m\x1d\xbaJ1\xcc<\x02'
    array = np.frombuffer(chunk, dtype=np.uint8)
    expected_entropy = 7.95638
    actual_entropy = calculate_shannon_entropy(array)
    rounded_entropy = round(expected_entropy, 5)
    assert rounded_entropy == expected_entropy


def test_calculate_entropy_with_random_byte_string1():
    array = np.frombuffer(random_byte1, dtype=np.uint8)
    entropy = calculate_shannon_entropy(array).round(5)
    rounded_entropy = round(entropy, 5)
    print(entropy, rounded_entropy, random_byte1.hex())
    assert rounded_entropy == entropy

def test_calculate_entropy_with_random_byte_string2():
    array = np.frombuffer(random_byte2, dtype=np.uint8)
    entropy = calculate_shannon_entropy(array).round(5)
    rounded_entropy = round(entropy, 5)
    print(entropy, rounded_entropy, random_byte2.hex())
    assert rounded_entropy == entropy

def test_calculate_entropy_with_random_byte_string3():
    array = np.frombuffer(random_byte3, dtype=np.uint8)
    entropy = calculate_shannon_entropy(array).round(5)
    rounded_entropy = round(entropy, 5)
    print(entropy, rounded_entropy, random_byte3.hex())
    assert rounded_entropy == entropy

def test_calculate_chi_square():
    #f_obs = np.bincount(np.frombuffer(random_byte1, dtype=np.uint8), minlength=256)
    chi2_statistic, p_value = calculate_chi2(random_byte1)
    print(chi2_statistic, p_value, random_byte1.hex())
    assert chi2_statistic == 1

def test_calculate_chi2():
    chunk = b'U\xd2\xdee\xa7r!\xb1j\xbf&\xa9\x8f\xd0\x8b:\\2%\xecJ\xedd\xbe\x89"\xac\xff\x83\xab\xfa\xee\xecx8\x9e\xb1\xf5\x16\x1cu\xb1\xc2\xd00\x15!\xb4aO\xc1\x9c\t\xf1)^p\xae\xa5\\\xc4 \xe2\x9f\xdc_\xd9\xf3\x93\x05\x14\xa5a\x8bs\xf4\xf6\x9c\xf9m]\xba\xa5\xc0\xbc\xe4++\xc2qV 9\x8e\xe5nx\x91[\x12ZoUv\x7fgq\xc2a\x16Y]\xba\xa3\xfcn\xb04\x13\t\xcbQD\n\xa7R4\x861\xff\xb6\xc3\xd7\xf83h\xe2\xee\xaf\x7f]W\xb5X`\xa2&h\xfb\xa1\xb7\xc3\x9b\x065\x90\xdf\xa1>\x80cz`\x94\x14\x92\x89a2G\xb1\xce\xe0\xa4\xd42\x9b`\x0b\xeeEJ\xdc\xca\x9d\xba\x86&\xbeT%\xa0R\x8b\xf3\x85\xe0\xf7\xa4\xf1\xafK\x94\x9d\xb0\xd7h\xaf\xa8\xa7\xe8\xeeo\x87\xcc4\xbe\x81O\xae\x8cTO5G\x84l\xe1\xde\xd6$\xeb\x8b\xce\xca\xeb\x92\xc1\x08\'\x07`J\x0eh\x9f\xce\xb0rg\xc0\x07~p\x1f\xf7\x0f\xd9\x91\xcc\x8aB\x0f\xa6U\xbfXH]\x85\xab\ry\xcde\xd5\x18\xd4\x18\x9b(PV\x9d\xe03\xb5\x1b\x02\x1dX\xda[>\xaei\xbd\x13j\x9a\xfaS\x89\x9c\xdc\x92=\xf8}\xc3 \x87]\x9b\tu\x9a\xad\xaa\xefs0\x95\xa2\xb0:\xb4\xc5\xff\xdc\x02q\xc2A)\xfe\xd2\x849\xfaO$*\xff@\xee\xc3\xca\x1dE\xff\x9a"\xf4\r\x85\xbf\xb0\xee\x82\xe3\xd0\xb9\xaf9\xc9\xd7\xef\xde\xa5;\x1f\x19G{\xd7Q\xff\xf5;&z\x18\xd2hNO\x96\xe6\xad\xf4\x1d\xe3\xf5\xdf\xa9\t&BW\xa5\xae\xc7\x8bx\x8a\xb5JA%+\xbc\x0e\xb0]\xf3\xf5!\xe8\x10X\xa1\x7f\xc9\xd0\xe4\xbf\xb2\xa9A\x14\x0c\x07\x91\xdfq\xab\x80\xf4\xf6\r\xa0\xe7u\t\x84\xb6\x18\xdb\xad\x8c\xa7\x00\x91\\Q\x90\xbf\x10p\xba\xb0".x\xd2\xf62\xf9\xd4(\xf7\xb7c\xe5t7D\x06\x81\x18"\xc3\xdf2nI\xdd\xe6\x8ae\xf0\xfa->v\xe6\xc7\xb7\xa9\x89K\xee\x8d\xf8\xf8\x12\xcfm~~\xd5\x9d\xf1\xcc\xab\xd4\xd9\xf5\x02\x03\xd8\xb5f\x8d\xa0\x13\xbe\xf0\x99\x8f^\xbd\xc1C\xf1mr\x157g\xcbxU\xe8)\x04\x04\x19\x81\x1f\xe0]\xba\xd9#\xfe\x84V\tX\xd6z]`>.jR\xd00\xb4\xc2\xf1\x94\xf9m\x808\\\x88D\xa5T\xd9!\\\xb34\x10\x10&GX\xef\x97f\xa6\x97y\xc5\xf7\xa5\x91\xdf\x8a,"\x9d\\\xe6>?\x8aq\x12\xc4\x8d\xb3;p4\xa3\xd4\xe9\xccqd:\xf1qS)\xf0f;2s\x145\tg\x94HjA\xf6S j\xd6\xbb\xaa\xc3U\xf9)=\xa7\x83\x14t\xa9\xf6\x9eY3L\x1cv\x8e\xaa\xf9\xdb\x96\x93\xe2<\xe8\xb32\x10\xe6(,\xdc*\xd2\x0b1(\x195\xc6\xfb\xb4\xf3\xb0\x08\x83\x845\xf1\x15iw1\x06k\x02_j3,\x99A}x\xb7\xfcb9\xech:\xb9R:|q\xe9\xef\xd96\xed\xdc\xd8\xe0\n\xf9ERZ\xf4\xd2\xae\xe5*\xe6a\x07\xfdQ\xf7\x90\x8d$Rk\tM}\xdf\x9cJ\xe1w\xa8\xf3\x90(#\xc3\x06X1\xa59\x12t\xc6\xff\x93\xaf\x80\xaa\xe0\xb4\x08\xda\xa6\xbd\xe5N_\xe80\x90\x92\xcc\x0e\xc5\x92=;\xa2/\x18@\xeaL\xf9\xb8\xde\xbeq\xef\xca\x07>\x90\x12\xec\xf4\x85\xe3\x9c\xcdq|\x18\n\xa7%\x8cS\xd93\xb2\x8e\xdf)\xa5p\xd6\x8a\x93\xc5\xc0\xfd\xfdT\xde\x17tH?\x87\xb1\xce\xb8\xf0 s\x8f$\xf4\x15\x95\xb3,>\xbc\x90}\xe9\xf8ch\xf1\xa9R\x19\xfa\xa6\x8a\xa1\xdc\xde\x81\xbf\x8d%\x90+n$7jc\xc0\x10\x15\x966dw\xf6\xa8\x1e\x82\x9d\xbf\x92\xfci\xf0\xe5!"8\xb6\xc0s\x16\xe9\xa7\xeeWh\xb9\x14E\x9c.\x18x\xfe\xcf:\x16^\t\xcc]\xea\xab&\x86\xf5\x7f\x99\xb1\x03^\xcbf\x85E\xb8\xd2_8\xd2\xaa\x89b\x9cQ,:\x9e\xcd4\x83\xbcD\x8b\x81L\x93\xeebjGy\xa0\xca\xa7\x87\x9c\x80\x89f+\xf0v\x91C\x19\xdd\x0bk\x9c \xa0\xd8\xf0\x0cmG.U\xfd\x94\x1aSm\x8aC\xfa\x92\xc2\xe9;\x89\x0e\x86%\x9f\x18\x16\xd7\xb4\xcf\xcfh\xe0/\xb7\x83\xf1f\xf0v%8\x9f9\x8e\x1e\xbe5\x93\x81\xf8\xf3\x03\x81_\x05\x82\xfe(P\\\x93^P \xd9\x92\xb7Z\x1e2\x15A\xfc\xa5\xbd\xa8\x01@\xeb`b\xbb\xc7\x84Rd_k\xff4\x1c\'A\x91\x9f\x9bS\x19\xbaV\xe8\xde\xac\x98\x89\xab~6\x81\xce\xa3[\xd5\x82\xd9\x96\x05\x81\xb7\x9b\xc2\xfbCB\xa8{\xbe\xac"\x1b\xcc\xa6\xea\x8a\x86\x1c8\xed\x04ce\xac\x1f\t\\\xdc\xf3;T\xec\x91\x84\xfe\xd3\x0bo`H\x9b\x9f\x83\xadWMz(H\xe9\xbe0\x00&\x80\x7ffj\x1cF\x84\x9d_\x08\x0c*\x1a5\x86\xc5N#\x9b8s|\x13_R\\\xbb\xa2?$@\x956\xdaM\xcb\x9ai\xa7gM\x08Fu+\xdbj\xa4\xf3#\x1a&\xae{8\xec)6\x06\xce\x05\xa5j\x1dg8\xf2t\xdc\xe96Y\x8b\xdb8\x7fm\xbf\\\xc7\tkD\xab\x90u\x18\xa0\x9e;]G\xd0!\xcb1\xa9"\xac\xf0`\xef\xa0x\x81\x8f \xf3\x90\xd0S\xc9k\xa4\\\x94\x92s\xd4\x15\xe1\x137\xa4\xa6\xd6\xdeg\x85\xa3\xcc\x87\tR\x01\x0e\x17\x0c\xcd\xb7\x84u\xec\xe6\xa1\x01z\xcf\'\xd6\x0f\xeeE`C\\6H\xe3\xe9\x9a\x81KS*\xc3*\x03\xeb\x17\xf4*\x8df\xf6%\xbd\x86\xec\xb3j\x1b\xff\xbe\xd6\x01\x13R\xff\xb5&\x8a\xb9)\xe0;\xa5[4E\xbf\xf0\x8f\xd2\xa6\x19p\xd1~\xe1\x1f\xd5\x15\xff\x10\x9eM\x08\xc253\x10O:\x99\xde\x19\x8f\xb7\xa7q\x0b\x8d\xf1\xbd\xb4r\xfb=4\x99\x0c~\xb4\x05\x0e\xad\x8a\xbb@y\xc8\xe8t\xec`\x88q*U\xce=F\xeb;\xdfM\x0f\x90OG\xc1\xf3wENY\xbe\xd9gw;B\x87?\xf7\xf8\x11\x88\x80\xbc\xe4J\x92\xf3)4w>\x195w\xad\x1e\xdeH3\xc6a\xdd5\xc1\xf1\xae\x0e>\x92\x8c\xcd\xf7]u\xa5\x8dT\xe4u\xee\xf3\xbbz\xb4\xe7"\xd7\x04\x1a\xeb\xab\x8f\xb8\xcfEC\x1f\'0\xa9\x93l\x1cq\x9f\xc5\xf7>\x81\x01\xdb/J\x05\xf5j:W>\x891\x94I7~\xba\xc1bA\xb1\xc9\x11=,\xf9CB\xda\xe4&\xa1\xf2\xe2d\xb9d\xa2\xf7A\x90\xd2=TfX\x0b\xec8dS\xce\xa5\x8dw\xb3\\]\xe3\xbb\xc2N|N\xe4\x18\x81Y1AX\xb6\x18\xffj\x10\xb1\xb2\xb48\x8c\x14Y\x95\xfa\x82(\'^\xe4\x8e\x02\x8e\xa8\xc0e\xb8\x01\xa4c\x8f\xd3\x96\xe3\xd2\xf7\xc3\xd3!\x94\xdf\x16\xc2\xe9\xe0\xa0E\x0f\xb1\x0f>\x01\x8e\xc6(%\xeb\x05M\x0f\xf8i\x1a0\xb30t\xe6\xc1\x92y\x9a.\xbcc\xd3\xdbs\x19@\x0bm\xcc\xac\x10\xc6\xd2\xdb^<\xbd!\xaa\xd0wO\xb5\xfeS\xfe]\x04W\x8b\xf4`\xd5bn\xcb\xfe%z\xdd\xe4^\x9f\xcaX`\xbeP9\xef\xdf\x19eX1.\x14\xcd%\xd3\xe0\xe9s\x04\xd2\xe5\xa6\xd4zv\x1d\x86f\xdb\x14\r\xb0R\x048\xe1R\xeap\xe8\xfeq\xf6m\xeb\xbbl\x166\x9d\x8e\x95\xb0\x90\xd8\x95\xab[\x9a\x05/\xf82s\xbcm9\x0b\x94\xcc\xdd\x19\xd1\xec;\xeaD\x14\xd0\xfa\x90iSn\x94s\x83@\xbb\xec\xfdw~\xe9\xd5\xc0\x9e\xbd\xf3\x06>2/\n\xda\x14f\xde\r\xd8\xd3\x93e.r-^h\xb4*\xe54U\x11\xae\xafm\x06\x8en\xb5\xe4\x1a2F\xf7\xb5\xbd\xb8Y\xa8\x0b\xd0\xb5\xc8*\xa89#_\x96\x82I\x88N\xab\xb0\xcd\xb4\xb1\x1d]\xb5\x8a?\x04\xbb\x83\x17\xd9\x07p\xf2\x9aS\x90\xcea\x93\xb4\xe6\xa5\x97"\xb3\x96\xe4Y\xb18Z\x85\x84osEs\xde\'z\x9b\xe2\xc5\xcb\xa9\xd3\xa0\xd0Ig+\xfev\xca\x1e\xb8\xfa\xb1oe\xb7V\xff\x00\xb98\xd9\xaaB \x01\xa4*q]\xcf\xd5\xd4(\x02 _\x84!\x95\xdcuPk}\xb6v\xc4\x046_u\xd7\xf7\xce\x9b\xfdSM\xbe\x9a\x82\xc6A\x11G\x812\xa5\xc4E\xcd\xe6\xea\x81]A\xf9\x9c\xdf\x85.3y\xb3\xa1\xc5\x8f\xf1lZ\x12\xc6\x01\xa7\xb9g\x19\xb15zW4:IgA\x93^\xfc<\xc0n !\xff\xdcd\xca\x971K5\x19\xcb\x0e`:\xbb\x89Do\x0fV\x80p\x96\xb6\t\x0f#\x89\x9b\x88\x11\xcf\xfe\xee\xeat\x9a\xf1\xe9v\xcd\xe6\xa4y)R\x82Z\xbd`\xb8\x93\xb1\x1b\'\xdb\x08\rc<D\xf0F$\xe0\xce%\xd4\xb5\x04\xe9"\x8a\x16\xc2\xe149\xa6\xa3\x98\xddv\x7f\xc6y\xa7y\x0cb]\x8b\x8e\xc67\xa4\x86i\xa2\x99\x02I`0J\xd0\xa50\xff\xf6R\x08\x0b\xf0b\xfb\x9f\xba/RzV\xbd\xb0n\\\x81K\xcc\xaan\xf8\xd5\'\x13&+\x8f\x048\x03c\x11N\xac\xeb\xe6\xd98IG\x10\xb3&%\xf8d\x07\x04\n\x12\xca\xa1\x06$\xe3U\xeb\x88A\x82`\xcf\xfe\xc0\xdc\xa8\xf0\xc4\x8e,<\xc4\xa4\x08~\xfb\x0c+!\xd4(\xba\xcaFB<\x90;<tu\xaa)Y7\xa6\x88\x1fy\xc9\x9d6\xf5\xbdD}\xc8Lj\x9c.\x95\x99h\xbe\x1bO\xc5ps\x0c\x84\xe64\x02\xb2V\xedj\x1bHP\x971\x04\xcb\xa3\xe23\x84\xae/5\x1dR\x06\xc5\x89\xdd&\xd1\xb14\x80f\x12t\xbe\x04wn\xff\t\xeepj\xde6\xcf-\xd6\x81\xaeF\x05\x03 \xd3\xe2?\x9c\xfe\x18 CW\xb5@a\xed\xce\x16\x0b\xac\x91#\xddsG\'\xfb[\x80\x05\xfc\x8e\x17\x88D\xf6\xef"\xc8<\xc1n\x05\xa0)\xb44B\xf2\x8c\x00u\xdd\x116\x94\xf2\x03OIY\x9b+\x97zd(\xaa\x9e\xee\xf2\xe7o{\xe5_\x86\xec\x9f\x90\xf4WF\xdc\xefL\x9b\xdd\x847\xeb\xcb8\xae\x10\xbb\xbd\xa4\t\xec\'\xa9\x9d\xaa<\x15\'\x16\xa0\xcd)\xf8j\x97\ta\x10r+*u\x15\xe9\x0e\x85?D\xf6\xc6\xde\x1f\x7f\x8fCc5\x02&.\x18h\xcf\x963{\xdcw>\xa89{\xff\x1ffe\xb2As\xe7\x90gwg\xd9\x13\xff\xc2\x10\xd4\xc9\x9b\xbaM\xe8R\x02\x15; r\xb0\xf1~l\x0c\xce7<5\x1cRt\x83\x0e\xc7,\x00<o\x93iE\xe1\t\xed\x98M\x8e!r\xc6\xdd8\xf6\x83\xcf\xa1K\n\x84\xd5)\xcc\x8b\x1c;\x80\xda\n\xd1\xfe\xb0j\xf8Ku\xa0\x9a\t\xb2\x97\x89\xba/~\xe2\xc8\x80|w\x95\xa1\x9d\x01;\xdf4\x1a@-\x82\t\xf8\xd9\x91\xe2\xed\x9d3m\x08$r\xe1\xadq\x82\x02D\xf7\x15\xa0E<yh\x9f\xc4\xbc &\xd7\xb2@pm\xcf\xea&w\xa3|\xc8\xf6\xc7\x08\x84\xba\x85\x8f0\x87 0\xc3\xdf\xfb\r\xff\xb9:\xe8<:\xc4KNJ\x04\xe8\xa0@\x82b\x1e\x89 \x9eWd<\xda$Lc2\xa0p\xa0Q\xc3+R\x1dDx\xf7\xe6A\xcf)\xb4[\x16B\xb8g}MS\x1c\x81,N|\x12z\x9b\xea\xa3Q\xafO\xf5\xeb\x1c\xabl\x86\xefW\xd9\xdez3L\x16\xc5L#=\xb5\xf7m\xbf@\x1e\xe2 \xcc\xd5\xc7!R\xeco\xc3 Zv\xb8{r\x9ee\xc5\xad\x16\x8f\xb8\x1d\xd72\xa8\xc2\xf8\xc1\x080\xd8\x1a\x00\x1c\xb6\x16\x86cnS\xe7\x08\xbd\xc1r\xddX\xfd\xd2\xe0)\xa1^\xfb\xdeTV\xf0S\xc8r\x00\xb5D\xe7,\x1a\x19\x19i\x8a\xa2\x1cj\xd8\xd6\xe9(\xcb\xcc2\xe0\x90\xae-\xb3]\xdfx=\x17\xb9\xd8\xc3m\xac,\xa5\x97\xf6rTd_\x12\x94r\x83f\xe5h\x95 C\x9e\xce\x88\xf7\x10\xea^w\xca~vi\xddG}\x92\xea\xc6\xc0\xd7O\xe2O&*\xafEP\xecX\xb0\xcc+/\x96\xc7I\xbct\xa4\xf4\x1b\x9d\xd1\x00\xd2\\\xf4.\xd9\xad\x1fs\x82\x81\xab\x80j\xa3\xd4\xeb3Z\xc44\x96\xc4\xdd\xe2\xba\x1f\xeb\xf7-\x10#\xbf\xe5\xcd\xdbc|\x86G\xb2Y\xa9o\xb0hM\xa9&\xa0\x17_pe\x9de\xca\x0c\x82\x0c\xa2\xe7\x10\x82\x8fy[\xf4\xaelT\xad7\x8f\xa7\xda\xb5\x01~L\xd6\xa9\xb1e\x1d([\x9c\xdeZ\xc5P2\xe5\xd2\xa7N\xb8B\x19\xf9\x03U\xe4G\x8e\x0c\xda{\xc7\x06\x13\xa4\xf4\x0eE\xe5\xd6\xdc\x8e\xff\x90x\xbb\xa6\xaa-\x97_+\xc6"\n7\x04\xaf\xf9z\x92;\xe2M\xdc\x19%\xa4\x1f)\xe3\'\xfa\xf56\xae;\xff\xd5\'\xd3\\\xc9\xd0\xb5l\x11[%\\\xd8\xb5\xb4\\hO2\x8f2\xce\xc2f8Ru=\n\xa0{\xef\x19\x9d\x0bI\xa0\xa7c\xea\xb3M\x11\x8ez\xba\n\xce\xcf\x97\xc8\x81\x14\x90@*\x98OZ\x90;\x1d\x7f\xd8\xff\x06\x96g\xd1\xacHr\x0b\x18?iU\xdf\\\x88/\xc0\xc0\x19g\xde\xd6}\x19\xb0\xac\xf7Dk\xdf\xa2\xefRj\xa2(#r\xe5)\x00\n\x83\xb7\xb4\xc6~\xa3\xcb\xa2\xeb\xc5\x96(\xa6\x16\x0e\x1e\x92\x8c\xa2@\xa7\x08\x8d\x95v,_\xb8\xdcOb\'\\PN\x90))l\tWW\x19\xe7\xcd\x7fos\xd0\x80\xb8p\xfc\xa7\x97\x0c\x04s#\x9f1\xf4\xb0\xb7\xaaF2=nB\xdc\xe4\xa3\xf7\xcf9\x13\x9e\xdd\xd6\x8603\x95\x10\xf6y\x07\xde\x08B\xf4\x01\xc0!\xd1\xb7`\xce\xd5\x07\xfd\xe6H\x8d\xc2\xa4\x139\x05gv\xb1\xdf\x1aQe*$\x89\x05K\x1b\x038ZS1\xe5\x904\xd2\xf7\xbeG\x91`=Vx\xc6+\x86{O\x0e\xd6\x1e\xff\xd3\xf0\xf0\x04\xf6\x0c\x8b\x8f4C{\xe1\x065\x03\xa8\xd385,\xaf\xde\x81\xbb\x19\xd4[\xb3\x93\x9f\x9c\x8e\xfa\xcb\x88\xb7\xa4k\x92\x9bc\xe1\xe2\xc4N\xe1\xfe`\xd5T\xb6Q%0\xeew\x80\xdc\x080q4S\x17/\xc4\xbd\xad\'\xaf\x8b\x97\x8c\xafv\xa6\x9e\\Z}\x91I\xcd9\\\xfd\xf8\x95\'\xdb\xf5*\xb3>\xaa k\x89\xa6/v\x1d\xb0\\\xd7\x88N\xbc\xe4\xda\xe4\xf6\xe4\x08\xc3l\x9c\xd1.\x82%\xc6j\x97\xc9\x99x\xed\xed\xdaTbv\x80\x06\xe0\x19\x88\xa4\xf5&`\xff]" \x8f\xccd\xf1\x85\n*\x8f=Y\xb0\xc7\x84l9S\x1b\xcb\x97\xb0\xa7\xcd#\xf0\xdd\t\xc3\t\xf9\xcb\xb7P\x8c\xc3\x15"\x9d=8\xa3\xd7>\x0e\xc8\xea\x14TA\x850\x91\x93\xb9X\xc6r\xfc)\xab4\xa9GNzv<vB\xb9\xf0\xa3\\\xdfB\xb7\x9d\xa9\x99\xe2\xacg|\x9cf\x8d\x9c\xa8\xc3\xc8\xb5(\x1cS9d%c7\xd1\x02\xbe\xbe\x96cn\x91\x0c\xcd\xa0A\xb1\xdf\xd8\x024\xa4\xb8\xf0[\x92dx-\xea\xaah\xc9\xe8w\xa9\xde\x02\x11\xaf+\xe0\xbe\x98\xe0\xdb\xb6\xf5\xe7\xacW\x88\xf3w\xf8\xdf\xfc\x0c&!\xeeZ\xc6\xcf\x91-\xbf\xc3\xa4$\xac^K^N\xe87\xb8l8%\xe5\xd3\xf6OQ\x1f\xc9E\x0b\xfb\x81\x7fU\x00:s\x80\x03V\xed\xff:\xf2\xdc\xa0m\xf8%\xfd\xfa\xbb\']~FB`\xfdH\x0bR)]\xb3"\x14k\xc9\x07\xe8\xb1y\xde\'\x15C\xa3p\xc2s\xaa\xef\xcb0\xda\xac\x14\x95\x16]\xcbh\xa1\xe3\x02\xb7\x86\xa1\x18 \xc6\xee\\\xf3h(\x01\xd5\xe6\t\xa3\xe43h\xc8\xb1\xb9V\x87\x81\x85\x96{\xef\xc1\xe9\xd4H\xad\xc2u\xc2x\xa0&\x1d\x15\x0e\xd8\xf6.\xbc\xa0\xcc\x98\xf1<\x1a\xc0\x87\xedK\xde^N\xf3\xc9\x7f\x0cXu\xdf\xaf\x0eC\xae\'pr\x9d$\x14(\xce\xfa\xf6g\xf9\x15-\x17ty\xf9\xc1Qj\x8d\xeaz\x99\xb6\x80\xb9G\x04\x8b\xe0\xc1\x18pH\x84w]\xc40\x1d\x18\xba9\x1c\xb3\x1cj-\xa8\x10\x08\xb2\xf4\\E\xc8\xd7.8\x12\xc1\xc8\n\xda\xbc\xfd]\x8c\xf7qo^+</\xd2\x8b\xbf\xf9\xf3\xcf\xc5=\xeb1\xa2&\x92\xe9\xd9\x1b}\xe1\xdb6\xdcp\xbe\xd7<\x00A\x9c\x13\x9du\x18ff\xa6\xff6\x85\x1c\xa4\xbf\xdc\r5\xf4\x16\x82\xb0L\xc4\xb6\xc8\x98\xfb\x1db\xb6\x0f\xfd\xc1\x7fz\xaf\x92q\xec_\xb7I\x0f\xc1\x1d\x87\xbe 1UX.\xc84F\x117\xe4\x7fR\x05\xd0m[\x9e#\xa7\x0c/\x1a\xaf\xfb\xf1\xd2\xbe\xdc\xde\xc5\xe7\xd2-\xf9\x92\xe3\xdd\t\x1f\xc8?\xf0F\x8d\xdbg\x0c&\xd2\xa5m\x81\xbf}\xcd6`7(Y\xf4r\xe2i\xaf<\x155j\xb1~\xe9&\xe4\xb0%v\x1a\xb9%d\xe4\x128cS=W\x9f,\xac\x8e\x16\x9a\xdf\x1cI\xefO\xbd\x8e\xb7uX\xcf\xe7?T!\x97\x86"\xb8Ca\xd7\xbfuM\xbfg]X\x10\x8ar\x80(\xfe\x00\x88\xf0E\xfa\xfb\x8b\xb4\xef\xad\x84\t\x08\xfd\xc8\x19@\xb2z\xc5\x8f\xe9\xcc\x92\xd0\xd5\xec\x93\xac\xf5\x9ft\x10m\x1d\xbaJ1\xcc<\x02'
    hex_of_chunk = chunk.hex()
    #f_obs = np.bincount(np.frombuffer(chunk, dtype=np.uint8), minlength=256)
    chi2_statistic, p_value = calculate_chi2(chunk)
    alpha_value = 0.05
    print(chi2_statistic, p_value, hex_of_chunk)
    assert p_value > alpha_value

def test_calculate_chi2_from_chunk():
    chunk = b"y\x8fF\xb6\x01^7P\xb2\xffc\xd7\xdd\xf6\x00\x898\xb2\xdbg\xf7\xa7\xceC{\xecC\x96\xc9\xa1\xde\xba~\xb7\x1b\x89\xa9-F\xa8\xd1|Z/\xeb'U\xcc\x02{y\xa9\xb1f\xad(\t\xdb\xf2\x9e\xfc\xa1d="
    hexchunk = to_hex(chunk)
    f_obs = np.bincount(np.frombuffer(chunk, dtype=np.uint8), minlength=256)
    chi2_statistic, p_value = calculate_chi2(f_obs)
    print(" ")
    print(chi2_statistic, p_value, hexchunk)

def test_convert_to_nibbles():
    generator = convert_to_nibbles(random_byte2)
    print("  ")
    print(hex(next(generator))) # High
    print(hex(next(generator))) # Low


def test_bin():
    chunk = b'U\xd2\xdee\xa7r!\xb1j\xbf&\xa9\x8f\xd0\x8b:\\2%\xecJ\xedd\xbe\x89"\xac\xff\x83\xab\xfa\xee\xecx8\x9e\xb1\xf5\x16\x1cu\xb1\xc2\xd00\x15!\xb4aO\xc1\x9c\t\xf1)^p\xae\xa5\\\xc4 \xe2\x9f\xdc_\xd9\xf3\x93\x05\x14\xa5a\x8bs\xf4\xf6\x9c\xf9m]\xba\xa5\xc0\xbc\xe4++\xc2qV 9\x8e\xe5nx\x91[\x12ZoUv\x7fgq\xc2a\x16Y]\xba\xa3\xfcn\xb04\x13\t\xcbQD\n\xa7R4\x861\xff\xb6\xc3\xd7\xf83h\xe2\xee\xaf\x7f]W\xb5X`\xa2&h\xfb\xa1\xb7\xc3\x9b\x065\x90\xdf\xa1>\x80cz`\x94\x14\x92\x89a2G\xb1\xce\xe0\xa4\xd42\x9b`\x0b\xeeEJ\xdc\xca\x9d\xba\x86&\xbeT%\xa0R\x8b\xf3\x85\xe0\xf7\xa4\xf1\xafK\x94\x9d\xb0\xd7h\xaf\xa8\xa7\xe8\xeeo\x87\xcc4\xbe\x81O\xae\x8cTO5G\x84l\xe1\xde\xd6$\xeb\x8b\xce\xca\xeb\x92\xc1\x08\'\x07`J\x0eh\x9f\xce\xb0rg\xc0\x07~p\x1f\xf7\x0f\xd9\x91\xcc\x8aB\x0f\xa6U\xbfXH]\x85\xab\ry\xcde\xd5\x18\xd4\x18\x9b(PV\x9d\xe03\xb5\x1b\x02\x1dX\xda[>\xaei\xbd\x13j\x9a\xfaS\x89\x9c\xdc\x92=\xf8}\xc3 \x87]\x9b\tu\x9a\xad\xaa\xefs0\x95\xa2\xb0:\xb4\xc5\xff\xdc\x02q\xc2A)\xfe\xd2\x849\xfaO$*\xff@\xee\xc3\xca\x1dE\xff\x9a"\xf4\r\x85\xbf\xb0\xee\x82\xe3\xd0\xb9\xaf9\xc9\xd7\xef\xde\xa5;\x1f\x19G{\xd7Q\xff\xf5;&z\x18\xd2hNO\x96\xe6\xad\xf4\x1d\xe3\xf5\xdf\xa9\t&BW\xa5\xae\xc7\x8bx\x8a\xb5JA%+\xbc\x0e\xb0]\xf3\xf5!\xe8\x10X\xa1\x7f\xc9\xd0\xe4\xbf\xb2\xa9A\x14\x0c\x07\x91\xdfq\xab\x80\xf4\xf6\r\xa0\xe7u\t\x84\xb6\x18\xdb\xad\x8c\xa7\x00\x91\\Q\x90\xbf\x10p\xba\xb0".x\xd2\xf62\xf9\xd4(\xf7\xb7c\xe5t7D\x06\x81\x18"\xc3\xdf2nI\xdd\xe6\x8ae\xf0\xfa->v\xe6\xc7\xb7\xa9\x89K\xee\x8d\xf8\xf8\x12\xcfm~~\xd5\x9d\xf1\xcc\xab\xd4\xd9\xf5\x02\x03\xd8\xb5f\x8d\xa0\x13\xbe\xf0\x99\x8f^\xbd\xc1C\xf1mr\x157g\xcbxU\xe8)\x04\x04\x19\x81\x1f\xe0]\xba\xd9#\xfe\x84V\tX\xd6z]`>.jR\xd00\xb4\xc2\xf1\x94\xf9m\x808\\\x88D\xa5T\xd9!\\\xb34\x10\x10&GX\xef\x97f\xa6\x97y\xc5\xf7\xa5\x91\xdf\x8a,"\x9d\\\xe6>?\x8aq\x12\xc4\x8d\xb3;p4\xa3\xd4\xe9\xccqd:\xf1qS)\xf0f;2s\x145\tg\x94HjA\xf6S j\xd6\xbb\xaa\xc3U\xf9)=\xa7\x83\x14t\xa9\xf6\x9eY3L\x1cv\x8e\xaa\xf9\xdb\x96\x93\xe2<\xe8\xb32\x10\xe6(,\xdc*\xd2\x0b1(\x195\xc6\xfb\xb4\xf3\xb0\x08\x83\x845\xf1\x15iw1\x06k\x02_j3,\x99A}x\xb7\xfcb9\xech:\xb9R:|q\xe9\xef\xd96\xed\xdc\xd8\xe0\n\xf9ERZ\xf4\xd2\xae\xe5*\xe6a\x07\xfdQ\xf7\x90\x8d$Rk\tM}\xdf\x9cJ\xe1w\xa8\xf3\x90(#\xc3\x06X1\xa59\x12t\xc6\xff\x93\xaf\x80\xaa\xe0\xb4\x08\xda\xa6\xbd\xe5N_\xe80\x90\x92\xcc\x0e\xc5\x92=;\xa2/\x18@\xeaL\xf9\xb8\xde\xbeq\xef\xca\x07>\x90\x12\xec\xf4\x85\xe3\x9c\xcdq|\x18\n\xa7%\x8cS\xd93\xb2\x8e\xdf)\xa5p\xd6\x8a\x93\xc5\xc0\xfd\xfdT\xde\x17tH?\x87\xb1\xce\xb8\xf0 s\x8f$\xf4\x15\x95\xb3,>\xbc\x90}\xe9\xf8ch\xf1\xa9R\x19\xfa\xa6\x8a\xa1\xdc\xde\x81\xbf\x8d%\x90+n$7jc\xc0\x10\x15\x966dw\xf6\xa8\x1e\x82\x9d\xbf\x92\xfci\xf0\xe5!"8\xb6\xc0s\x16\xe9\xa7\xeeWh\xb9\x14E\x9c.\x18x\xfe\xcf:\x16^\t\xcc]\xea\xab&\x86\xf5\x7f\x99\xb1\x03^\xcbf\x85E\xb8\xd2_8\xd2\xaa\x89b\x9cQ,:\x9e\xcd4\x83\xbcD\x8b\x81L\x93\xeebjGy\xa0\xca\xa7\x87\x9c\x80\x89f+\xf0v\x91C\x19\xdd\x0bk\x9c \xa0\xd8\xf0\x0cmG.U\xfd\x94\x1aSm\x8aC\xfa\x92\xc2\xe9;\x89\x0e\x86%\x9f\x18\x16\xd7\xb4\xcf\xcfh\xe0/\xb7\x83\xf1f\xf0v%8\x9f9\x8e\x1e\xbe5\x93\x81\xf8\xf3\x03\x81_\x05\x82\xfe(P\\\x93^P \xd9\x92\xb7Z\x1e2\x15A\xfc\xa5\xbd\xa8\x01@\xeb`b\xbb\xc7\x84Rd_k\xff4\x1c\'A\x91\x9f\x9bS\x19\xbaV\xe8\xde\xac\x98\x89\xab~6\x81\xce\xa3[\xd5\x82\xd9\x96\x05\x81\xb7\x9b\xc2\xfbCB\xa8{\xbe\xac"\x1b\xcc\xa6\xea\x8a\x86\x1c8\xed\x04ce\xac\x1f\t\\\xdc\xf3;T\xec\x91\x84\xfe\xd3\x0bo`H\x9b\x9f\x83\xadWMz(H\xe9\xbe0\x00&\x80\x7ffj\x1cF\x84\x9d_\x08\x0c*\x1a5\x86\xc5N#\x9b8s|\x13_R\\\xbb\xa2?$@\x956\xdaM\xcb\x9ai\xa7gM\x08Fu+\xdbj\xa4\xf3#\x1a&\xae{8\xec)6\x06\xce\x05\xa5j\x1dg8\xf2t\xdc\xe96Y\x8b\xdb8\x7fm\xbf\\\xc7\tkD\xab\x90u\x18\xa0\x9e;]G\xd0!\xcb1\xa9"\xac\xf0`\xef\xa0x\x81\x8f \xf3\x90\xd0S\xc9k\xa4\\\x94\x92s\xd4\x15\xe1\x137\xa4\xa6\xd6\xdeg\x85\xa3\xcc\x87\tR\x01\x0e\x17\x0c\xcd\xb7\x84u\xec\xe6\xa1\x01z\xcf\'\xd6\x0f\xeeE`C\\6H\xe3\xe9\x9a\x81KS*\xc3*\x03\xeb\x17\xf4*\x8df\xf6%\xbd\x86\xec\xb3j\x1b\xff\xbe\xd6\x01\x13R\xff\xb5&\x8a\xb9)\xe0;\xa5[4E\xbf\xf0\x8f\xd2\xa6\x19p\xd1~\xe1\x1f\xd5\x15\xff\x10\x9eM\x08\xc253\x10O:\x99\xde\x19\x8f\xb7\xa7q\x0b\x8d\xf1\xbd\xb4r\xfb=4\x99\x0c~\xb4\x05\x0e\xad\x8a\xbb@y\xc8\xe8t\xec`\x88q*U\xce=F\xeb;\xdfM\x0f\x90OG\xc1\xf3wENY\xbe\xd9gw;B\x87?\xf7\xf8\x11\x88\x80\xbc\xe4J\x92\xf3)4w>\x195w\xad\x1e\xdeH3\xc6a\xdd5\xc1\xf1\xae\x0e>\x92\x8c\xcd\xf7]u\xa5\x8dT\xe4u\xee\xf3\xbbz\xb4\xe7"\xd7\x04\x1a\xeb\xab\x8f\xb8\xcfEC\x1f\'0\xa9\x93l\x1cq\x9f\xc5\xf7>\x81\x01\xdb/J\x05\xf5j:W>\x891\x94I7~\xba\xc1bA\xb1\xc9\x11=,\xf9CB\xda\xe4&\xa1\xf2\xe2d\xb9d\xa2\xf7A\x90\xd2=TfX\x0b\xec8dS\xce\xa5\x8dw\xb3\\]\xe3\xbb\xc2N|N\xe4\x18\x81Y1AX\xb6\x18\xffj\x10\xb1\xb2\xb48\x8c\x14Y\x95\xfa\x82(\'^\xe4\x8e\x02\x8e\xa8\xc0e\xb8\x01\xa4c\x8f\xd3\x96\xe3\xd2\xf7\xc3\xd3!\x94\xdf\x16\xc2\xe9\xe0\xa0E\x0f\xb1\x0f>\x01\x8e\xc6(%\xeb\x05M\x0f\xf8i\x1a0\xb30t\xe6\xc1\x92y\x9a.\xbcc\xd3\xdbs\x19@\x0bm\xcc\xac\x10\xc6\xd2\xdb^<\xbd!\xaa\xd0wO\xb5\xfeS\xfe]\x04W\x8b\xf4`\xd5bn\xcb\xfe%z\xdd\xe4^\x9f\xcaX`\xbeP9\xef\xdf\x19eX1.\x14\xcd%\xd3\xe0\xe9s\x04\xd2\xe5\xa6\xd4zv\x1d\x86f\xdb\x14\r\xb0R\x048\xe1R\xeap\xe8\xfeq\xf6m\xeb\xbbl\x166\x9d\x8e\x95\xb0\x90\xd8\x95\xab[\x9a\x05/\xf82s\xbcm9\x0b\x94\xcc\xdd\x19\xd1\xec;\xeaD\x14\xd0\xfa\x90iSn\x94s\x83@\xbb\xec\xfdw~\xe9\xd5\xc0\x9e\xbd\xf3\x06>2/\n\xda\x14f\xde\r\xd8\xd3\x93e.r-^h\xb4*\xe54U\x11\xae\xafm\x06\x8en\xb5\xe4\x1a2F\xf7\xb5\xbd\xb8Y\xa8\x0b\xd0\xb5\xc8*\xa89#_\x96\x82I\x88N\xab\xb0\xcd\xb4\xb1\x1d]\xb5\x8a?\x04\xbb\x83\x17\xd9\x07p\xf2\x9aS\x90\xcea\x93\xb4\xe6\xa5\x97"\xb3\x96\xe4Y\xb18Z\x85\x84osEs\xde\'z\x9b\xe2\xc5\xcb\xa9\xd3\xa0\xd0Ig+\xfev\xca\x1e\xb8\xfa\xb1oe\xb7V\xff\x00\xb98\xd9\xaaB \x01\xa4*q]\xcf\xd5\xd4(\x02 _\x84!\x95\xdcuPk}\xb6v\xc4\x046_u\xd7\xf7\xce\x9b\xfdSM\xbe\x9a\x82\xc6A\x11G\x812\xa5\xc4E\xcd\xe6\xea\x81]A\xf9\x9c\xdf\x85.3y\xb3\xa1\xc5\x8f\xf1lZ\x12\xc6\x01\xa7\xb9g\x19\xb15zW4:IgA\x93^\xfc<\xc0n !\xff\xdcd\xca\x971K5\x19\xcb\x0e`:\xbb\x89Do\x0fV\x80p\x96\xb6\t\x0f#\x89\x9b\x88\x11\xcf\xfe\xee\xeat\x9a\xf1\xe9v\xcd\xe6\xa4y)R\x82Z\xbd`\xb8\x93\xb1\x1b\'\xdb\x08\rc<D\xf0F$\xe0\xce%\xd4\xb5\x04\xe9"\x8a\x16\xc2\xe149\xa6\xa3\x98\xddv\x7f\xc6y\xa7y\x0cb]\x8b\x8e\xc67\xa4\x86i\xa2\x99\x02I`0J\xd0\xa50\xff\xf6R\x08\x0b\xf0b\xfb\x9f\xba/RzV\xbd\xb0n\\\x81K\xcc\xaan\xf8\xd5\'\x13&+\x8f\x048\x03c\x11N\xac\xeb\xe6\xd98IG\x10\xb3&%\xf8d\x07\x04\n\x12\xca\xa1\x06$\xe3U\xeb\x88A\x82`\xcf\xfe\xc0\xdc\xa8\xf0\xc4\x8e,<\xc4\xa4\x08~\xfb\x0c+!\xd4(\xba\xcaFB<\x90;<tu\xaa)Y7\xa6\x88\x1fy\xc9\x9d6\xf5\xbdD}\xc8Lj\x9c.\x95\x99h\xbe\x1bO\xc5ps\x0c\x84\xe64\x02\xb2V\xedj\x1bHP\x971\x04\xcb\xa3\xe23\x84\xae/5\x1dR\x06\xc5\x89\xdd&\xd1\xb14\x80f\x12t\xbe\x04wn\xff\t\xeepj\xde6\xcf-\xd6\x81\xaeF\x05\x03 \xd3\xe2?\x9c\xfe\x18 CW\xb5@a\xed\xce\x16\x0b\xac\x91#\xddsG\'\xfb[\x80\x05\xfc\x8e\x17\x88D\xf6\xef"\xc8<\xc1n\x05\xa0)\xb44B\xf2\x8c\x00u\xdd\x116\x94\xf2\x03OIY\x9b+\x97zd(\xaa\x9e\xee\xf2\xe7o{\xe5_\x86\xec\x9f\x90\xf4WF\xdc\xefL\x9b\xdd\x847\xeb\xcb8\xae\x10\xbb\xbd\xa4\t\xec\'\xa9\x9d\xaa<\x15\'\x16\xa0\xcd)\xf8j\x97\ta\x10r+*u\x15\xe9\x0e\x85?D\xf6\xc6\xde\x1f\x7f\x8fCc5\x02&.\x18h\xcf\x963{\xdcw>\xa89{\xff\x1ffe\xb2As\xe7\x90gwg\xd9\x13\xff\xc2\x10\xd4\xc9\x9b\xbaM\xe8R\x02\x15; r\xb0\xf1~l\x0c\xce7<5\x1cRt\x83\x0e\xc7,\x00<o\x93iE\xe1\t\xed\x98M\x8e!r\xc6\xdd8\xf6\x83\xcf\xa1K\n\x84\xd5)\xcc\x8b\x1c;\x80\xda\n\xd1\xfe\xb0j\xf8Ku\xa0\x9a\t\xb2\x97\x89\xba/~\xe2\xc8\x80|w\x95\xa1\x9d\x01;\xdf4\x1a@-\x82\t\xf8\xd9\x91\xe2\xed\x9d3m\x08$r\xe1\xadq\x82\x02D\xf7\x15\xa0E<yh\x9f\xc4\xbc &\xd7\xb2@pm\xcf\xea&w\xa3|\xc8\xf6\xc7\x08\x84\xba\x85\x8f0\x87 0\xc3\xdf\xfb\r\xff\xb9:\xe8<:\xc4KNJ\x04\xe8\xa0@\x82b\x1e\x89 \x9eWd<\xda$Lc2\xa0p\xa0Q\xc3+R\x1dDx\xf7\xe6A\xcf)\xb4[\x16B\xb8g}MS\x1c\x81,N|\x12z\x9b\xea\xa3Q\xafO\xf5\xeb\x1c\xabl\x86\xefW\xd9\xdez3L\x16\xc5L#=\xb5\xf7m\xbf@\x1e\xe2 \xcc\xd5\xc7!R\xeco\xc3 Zv\xb8{r\x9ee\xc5\xad\x16\x8f\xb8\x1d\xd72\xa8\xc2\xf8\xc1\x080\xd8\x1a\x00\x1c\xb6\x16\x86cnS\xe7\x08\xbd\xc1r\xddX\xfd\xd2\xe0)\xa1^\xfb\xdeTV\xf0S\xc8r\x00\xb5D\xe7,\x1a\x19\x19i\x8a\xa2\x1cj\xd8\xd6\xe9(\xcb\xcc2\xe0\x90\xae-\xb3]\xdfx=\x17\xb9\xd8\xc3m\xac,\xa5\x97\xf6rTd_\x12\x94r\x83f\xe5h\x95 C\x9e\xce\x88\xf7\x10\xea^w\xca~vi\xddG}\x92\xea\xc6\xc0\xd7O\xe2O&*\xafEP\xecX\xb0\xcc+/\x96\xc7I\xbct\xa4\xf4\x1b\x9d\xd1\x00\xd2\\\xf4.\xd9\xad\x1fs\x82\x81\xab\x80j\xa3\xd4\xeb3Z\xc44\x96\xc4\xdd\xe2\xba\x1f\xeb\xf7-\x10#\xbf\xe5\xcd\xdbc|\x86G\xb2Y\xa9o\xb0hM\xa9&\xa0\x17_pe\x9de\xca\x0c\x82\x0c\xa2\xe7\x10\x82\x8fy[\xf4\xaelT\xad7\x8f\xa7\xda\xb5\x01~L\xd6\xa9\xb1e\x1d([\x9c\xdeZ\xc5P2\xe5\xd2\xa7N\xb8B\x19\xf9\x03U\xe4G\x8e\x0c\xda{\xc7\x06\x13\xa4\xf4\x0eE\xe5\xd6\xdc\x8e\xff\x90x\xbb\xa6\xaa-\x97_+\xc6"\n7\x04\xaf\xf9z\x92;\xe2M\xdc\x19%\xa4\x1f)\xe3\'\xfa\xf56\xae;\xff\xd5\'\xd3\\\xc9\xd0\xb5l\x11[%\\\xd8\xb5\xb4\\hO2\x8f2\xce\xc2f8Ru=\n\xa0{\xef\x19\x9d\x0bI\xa0\xa7c\xea\xb3M\x11\x8ez\xba\n\xce\xcf\x97\xc8\x81\x14\x90@*\x98OZ\x90;\x1d\x7f\xd8\xff\x06\x96g\xd1\xacHr\x0b\x18?iU\xdf\\\x88/\xc0\xc0\x19g\xde\xd6}\x19\xb0\xac\xf7Dk\xdf\xa2\xefRj\xa2(#r\xe5)\x00\n\x83\xb7\xb4\xc6~\xa3\xcb\xa2\xeb\xc5\x96(\xa6\x16\x0e\x1e\x92\x8c\xa2@\xa7\x08\x8d\x95v,_\xb8\xdcOb\'\\PN\x90))l\tWW\x19\xe7\xcd\x7fos\xd0\x80\xb8p\xfc\xa7\x97\x0c\x04s#\x9f1\xf4\xb0\xb7\xaaF2=nB\xdc\xe4\xa3\xf7\xcf9\x13\x9e\xdd\xd6\x8603\x95\x10\xf6y\x07\xde\x08B\xf4\x01\xc0!\xd1\xb7`\xce\xd5\x07\xfd\xe6H\x8d\xc2\xa4\x139\x05gv\xb1\xdf\x1aQe*$\x89\x05K\x1b\x038ZS1\xe5\x904\xd2\xf7\xbeG\x91`=Vx\xc6+\x86{O\x0e\xd6\x1e\xff\xd3\xf0\xf0\x04\xf6\x0c\x8b\x8f4C{\xe1\x065\x03\xa8\xd385,\xaf\xde\x81\xbb\x19\xd4[\xb3\x93\x9f\x9c\x8e\xfa\xcb\x88\xb7\xa4k\x92\x9bc\xe1\xe2\xc4N\xe1\xfe`\xd5T\xb6Q%0\xeew\x80\xdc\x080q4S\x17/\xc4\xbd\xad\'\xaf\x8b\x97\x8c\xafv\xa6\x9e\\Z}\x91I\xcd9\\\xfd\xf8\x95\'\xdb\xf5*\xb3>\xaa k\x89\xa6/v\x1d\xb0\\\xd7\x88N\xbc\xe4\xda\xe4\xf6\xe4\x08\xc3l\x9c\xd1.\x82%\xc6j\x97\xc9\x99x\xed\xed\xdaTbv\x80\x06\xe0\x19\x88\xa4\xf5&`\xff]" \x8f\xccd\xf1\x85\n*\x8f=Y\xb0\xc7\x84l9S\x1b\xcb\x97\xb0\xa7\xcd#\xf0\xdd\t\xc3\t\xf9\xcb\xb7P\x8c\xc3\x15"\x9d=8\xa3\xd7>\x0e\xc8\xea\x14TA\x850\x91\x93\xb9X\xc6r\xfc)\xab4\xa9GNzv<vB\xb9\xf0\xa3\\\xdfB\xb7\x9d\xa9\x99\xe2\xacg|\x9cf\x8d\x9c\xa8\xc3\xc8\xb5(\x1cS9d%c7\xd1\x02\xbe\xbe\x96cn\x91\x0c\xcd\xa0A\xb1\xdf\xd8\x024\xa4\xb8\xf0[\x92dx-\xea\xaah\xc9\xe8w\xa9\xde\x02\x11\xaf+\xe0\xbe\x98\xe0\xdb\xb6\xf5\xe7\xacW\x88\xf3w\xf8\xdf\xfc\x0c&!\xeeZ\xc6\xcf\x91-\xbf\xc3\xa4$\xac^K^N\xe87\xb8l8%\xe5\xd3\xf6OQ\x1f\xc9E\x0b\xfb\x81\x7fU\x00:s\x80\x03V\xed\xff:\xf2\xdc\xa0m\xf8%\xfd\xfa\xbb\']~FB`\xfdH\x0bR)]\xb3"\x14k\xc9\x07\xe8\xb1y\xde\'\x15C\xa3p\xc2s\xaa\xef\xcb0\xda\xac\x14\x95\x16]\xcbh\xa1\xe3\x02\xb7\x86\xa1\x18 \xc6\xee\\\xf3h(\x01\xd5\xe6\t\xa3\xe43h\xc8\xb1\xb9V\x87\x81\x85\x96{\xef\xc1\xe9\xd4H\xad\xc2u\xc2x\xa0&\x1d\x15\x0e\xd8\xf6.\xbc\xa0\xcc\x98\xf1<\x1a\xc0\x87\xedK\xde^N\xf3\xc9\x7f\x0cXu\xdf\xaf\x0eC\xae\'pr\x9d$\x14(\xce\xfa\xf6g\xf9\x15-\x17ty\xf9\xc1Qj\x8d\xeaz\x99\xb6\x80\xb9G\x04\x8b\xe0\xc1\x18pH\x84w]\xc40\x1d\x18\xba9\x1c\xb3\x1cj-\xa8\x10\x08\xb2\xf4\\E\xc8\xd7.8\x12\xc1\xc8\n\xda\xbc\xfd]\x8c\xf7qo^+</\xd2\x8b\xbf\xf9\xf3\xcf\xc5=\xeb1\xa2&\x92\xe9\xd9\x1b}\xe1\xdb6\xdcp\xbe\xd7<\x00A\x9c\x13\x9du\x18ff\xa6\xff6\x85\x1c\xa4\xbf\xdc\r5\xf4\x16\x82\xb0L\xc4\xb6\xc8\x98\xfb\x1db\xb6\x0f\xfd\xc1\x7fz\xaf\x92q\xec_\xb7I\x0f\xc1\x1d\x87\xbe 1UX.\xc84F\x117\xe4\x7fR\x05\xd0m[\x9e#\xa7\x0c/\x1a\xaf\xfb\xf1\xd2\xbe\xdc\xde\xc5\xe7\xd2-\xf9\x92\xe3\xdd\t\x1f\xc8?\xf0F\x8d\xdbg\x0c&\xd2\xa5m\x81\xbf}\xcd6`7(Y\xf4r\xe2i\xaf<\x155j\xb1~\xe9&\xe4\xb0%v\x1a\xb9%d\xe4\x128cS=W\x9f,\xac\x8e\x16\x9a\xdf\x1cI\xefO\xbd\x8e\xb7uX\xcf\xe7?T!\x97\x86"\xb8Ca\xd7\xbfuM\xbfg]X\x10\x8ar\x80(\xfe\x00\x88\xf0E\xfa\xfb\x8b\xb4\xef\xad\x84\t\x08\xfd\xc8\x19@\xb2z\xc5\x8f\xe9\xcc\x92\xd0\xd5\xec\x93\xac\xf5\x9ft\x10m\x1d\xbaJ1\xcc<\x02'
    random_generated_byte = os.urandom(10)
    formatted_var = to_bin(random_byte1)
    formatted_var2 = to_hex(random_byte1)
    random_block = np.random.bytes(4096)
    random_block2 = os.urandom(4096)
    formatted_var3 = to_hex(random_block)
    formatted_var4 = to_hex(random_block2)
    #f_obs_of_chunk = np.bincount(np.frombuffer(chunk, dtype=np.uint8), minlength=256)
    #f_obs2 = np.bincount(np.frombuffer(random_block2, dtype=np.uint8), minlength=256)
    #f_obs = np.bincount(np.frombuffer(random_block, dtype=np.uint8), minlength=256)
    chi2_statistic, p_value = calculate_chi2(random_block)
    chi2_statistic2, p_value2 = calculate_chi2(random_block2)
    chi2_statistic3, p_value3 = calculate_chi2(chunk)
    print(" ")
    print(formatted_var3)
    print(chi2_statistic)
    print(p_value)
    print(" ")
    print(formatted_var4)
    print(chi2_statistic2)
    print(p_value2)
    print(" ")
    print("X^2 of chunk")
    print(chi2_statistic3)
    print(p_value3)
    print(to_hex(random_generated_byte))
    #print(formatted_var)
    #print(formatted_var2)
    #print(formatted_var3)

# NullHypothese = Die Bytes sind unabhängig
# Alternative Hypothese = Die Bytes sind signifikant abhängig
# p-Wert >> 0.05 -> H0 akzeptiert (Bytes sind unabhängig)
# p-Wert << 0.05 -> H0 abgelehnt (Bytes sind abhängig)
# p-Wert aus dem Test = 0.615824602417653 -> Es ist deutlich größer als der Signifikanzschwellenwert, bedeutet H0 wird akzeptiert und Bytes sind unabhängig voneinander
# Richtig, weil es sich um ein mit Krypto-Ransomware verschlüsseltem Chunk handelt